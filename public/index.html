<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vansono</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <div id="auth-view" class="view">
        <div class="auth-card">
            <h1>Vansono</h1>
            <div class="auth-step" id="step-email">
                <input id="email-input" type="email" placeholder="Email" autocomplete="email">
                <button id="get-code-btn">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
                <div class="oauth-row">
                    <a id="google-btn" class="google" href="/api/auth/google" style="display:block;text-align:center;padding:12px 14px;border-radius:8px;text-decoration:none;">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</a>
                </div>
            </div>
            <div class="auth-step" id="step-code" style="display:none;">
                <input id="code-input" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥" maxlength="6">
                <button id="verify-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
            <div class="auth-step" id="step-username" style="display:none;">
                <input id="username-input" type="text" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ @username">
                <button id="set-username-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
            <div id="auth-error" class="error"></div>
        </div>
    </div>

    <div id="app-view" class="view" style="display:none;">
        <aside class="sidebar">
            <div class="search">
                <input id="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ @username">
            </div>
            <div id="search-results" class="results" style="display:none;"></div>
            <div id="chats-list" class="chats"></div>
        </aside>
        <main class="chat">
            <div class="chat-header">
                <div id="chat-title">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</div>
                <div class="chat-actions">
                    <button id="call-btn" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">üìû</button>
                </div>
            </div>
            <div id="messages" class="messages"></div>
            <div class="composer">
                <input id="message-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
            </div>
        </main>
    </div>

    <div id="call-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div id="call-status">–ó–≤–æ–Ω–æ–∫...</div>
            <div class="call-controls">
                <button id="accept-call">–ü—Ä–∏–Ω—è—Ç—å</button>
                <button id="reject-call">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                <button id="hangup-call" style="display:none;">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                <button id="toggle-mic" style="display:none;">–ú–∏–∫—Ä–æ—Ñ–æ–Ω</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/simple-peer@9.11.1/simplepeer.min.js"></script>
    <script type="module" src="/app.js"></script>
</body>
<script>
// Prevent zoom on double tap on mobile
document.addEventListener('touchend', function (event) {
    const time = event.timeStamp;
    if (!document.lastTouchEnd) {
        document.lastTouchEnd = time;
        return;
    }
    const delta = time - document.lastTouchEnd;
    document.lastTouchEnd = time;
    if (delta < 350) event.preventDefault();
}, { passive: false });
</script>
</html>


